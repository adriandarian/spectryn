# Validate PR titles follow Conventional Commits
name: PR Title

on:
  pull_request_target:
    types: [opened, edited, synchronize, reopened]

permissions:
  pull-requests: read

jobs:
  validate:
    name: Validate PR Title
    runs-on: ubuntu-latest
    steps:
      - name: Check PR title format
        uses: amannn/action-semantic-pull-request@v5
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        with:
          # Configure which types are allowed
          types: |
            feat
            fix
            docs
            style
            refactor
            perf
            test
            build
            ci
            chore
            revert
            deps

          # Configure which scopes are allowed
          scopes: |
            core
            adapters
            cli
            application
            plugins
            docs
            tests
            ci
            deps
            vscode
            github-action
            config

          # Require a scope
          requireScope: false

          # Disable validation for merge commits
          ignoreLabels: |
            dependencies
            automated

          # Allow WIP PRs to skip validation
          wip: true

          # Custom error messages
          subjectPattern: ^(?![A-Z]).+$
          subjectPatternError: |
            The PR title "{title}" doesn't match the required format.

            Please use Conventional Commits format:
              <type>(<scope>): <description>

            Examples:
              feat(cli): add new sync command
              fix(core): resolve race condition in parser
              docs: update installation guide

            Allowed types: feat, fix, docs, style, refactor, perf, test, build, ci, chore, revert, deps

            See: https://www.conventionalcommits.org/
